# Стадия обратной подстановки метода исключения Гаусса

## Код обратной подстановки

После завершения прямого хода метода Гаусса матрица коэффициентов приводится к верхнетреугольному виду, и система имеет вид:

```
a₁₁x₁ + a₁₂x₂ + ... + a₁ₙxₙ = b₁
       a₂₂x₂ + ... + a₂ₙxₙ = b₂
             ...
                   aₙₙxₙ = bₙ
```

Обратная подстановка начинается с последнего уравнения и движется вверх:

```cpp
// Обратный ход метода Гаусса
std::vector<double> x(n);
for (int i = n - 1; i >= 0; --i) {
    x[i] = aug.b[i];
    for (int j = i + 1; j < n; ++j) {
        x[i] -= aug.A.data[i][j] * x[j];
    }
    x[i] /= aug.A.data[i][i];
}
```

## Пошаговое объяснение алгоритма

1. **Инициализация вектора решения:**
   ```cpp
   std::vector<double> x(n);
   ```

2. **Внешний цикл от n-1 до 0:**
   ```cpp
   for (int i = n - 1; i >= 0; --i) {
   ```

3. **Начальное значение для x[i]:**
   ```cpp
   x[i] = aug.b[i];
   ```
   Берем правую часть i-го уравнения

4. **Вычитание известных членов:**
   ```cpp
   for (int j = i + 1; j < n; ++j) {
       x[i] -= aug.A.data[i][j] * x[j];
   }
   ```
   Вычитаем произведения коэффициентов на уже найденные переменные

5. **Нормировка:**
   ```cpp
   x[i] /= aug.A.data[i][i];
   ```
   Делим на коэффициент при x[i] (который равен диагональному элементу)

## Анализ временной сложности

### Подсчет операций

Внешний цикл выполняется **n** раз (для каждого i от n-1 до 0).

Для каждого i внутренний цикл выполняется **(n - i - 1)** раз:
- Когда i = n-1: внутренний цикл не выполняется (0 раз)
- Когда i = n-2: внутренний цикл выполняется 1 раз (j = n-1)
- Когда i = n-3: внутренний цикл выполняется 2 раза (j = n-2, n-1)
- ...
- Когда i = 0: внутренний цикл выполняется (n-1) раз (j = 1, 2, ..., n-1)

Общее количество операций во внутреннем цикле:
```
Σ(i=0 to n-1) (n - i - 1) = (n-1) + (n-2) + ... + 1 + 0 = n(n-1)/2
```

### Асимптотическая сложность

Количество операций равно **n(n-1)/2**, что дает временную сложность **Θ(n²)**.

### Доказательство Θ(n²)

- **Нижняя граница Ω(n²):** Даже в лучшем случае (когда много коэффициентов равно нулю) мы имеем Ω(n²) операций
- **Верхняя граница O(n²):** Максимум n(n-1)/2 операций

Таким образом, время работы стадии обратной подстановки составляет **Θ(n²)**.

## Пример работы

Для системы 3×3 после прямого хода имеем:

```
[1  2  3]   [x₁]   [6 ]
[0  1  4] × [x₂] = [8 ]
[0  0  1]   [x₃]   [10]
```

Обратная подстановка:

1. **i = 2:** x₂ = 10/1 = 10
2. **i = 1:** x₁ = 8 - 4×10 = 8 - 40 = -32, затем x₁ /= 1 = -32
3. **i = 0:** x₀ = 6 - 2×(-32) - 3×10 = 6 + 64 - 30 = 40, затем x₀ /= 1 = 40

## Заключение

Стадия обратной подстановки метода Гаусса имеет квадратичную временную сложность Θ(n²), что делает её эффективной частью алгоритма, особенно по сравнению с прямым ходом, который также имеет сложность Θ(n³).