# Лабораторная работа №4: Численные методы решения нелинейных уравнений

## Оглавление
1. [Цель работы](#цель-работы)
2. [Постановка задачи](#постановка-задачи)
3. [Теоретическая часть](#теоретическая-часть)
4. [Практическая реализация](#практическая-реализация)
5. [Анализ результатов](#анализ-результатов)
6. [Инструкция по сборке и запуску](#инструкция-по-сборке-и-запуску)
7. [Ответы на возможные вопросы](#ответы-на-возможные-вопросы)

## Цель работы

**Основная цель**: Изучение и практическая реализация численных методов решения нелинейных уравнений на примере уравнения **x² - eˣ + 2 = 0**.

**Конкретные задачи**:
1. Реализовать три численных метода:
   - Метод половинного деления (бисекции)
   - Метод простых итераций
   - Метод Ньютона (касательных)
2. Найти корень уравнения с двумя различными точностями:
   - ε₁ = 10⁻⁶ (0.000001)
   - ε₂ = 10⁻¹¹ (0.00000000001)
3. Сравнить эффективность методов по количеству итераций и скорости сходимости
4. Проанализировать полученные результаты

## Постановка задачи

### Исходное уравнение
**Уравнение варианта 24**: 
```
x² - eˣ + 2 = 0
```

### Требуемые точности
1. **ε₁ = 1.0 × 10⁻⁶** (стандартная инженерная точность)
2. **ε₂ = 1.0 × 10⁻¹¹** (высокая точность для научных расчетов)

### Критерии остановки
Для всех методов используются два критерия остановки:
1. **По значению функции**: |f(xₙ)| < ε
2. **По изменению аргумента**: |xₙ₊₁ - xₙ| < ε

## Теоретическая часть

### 1. Метод половинного деления (Бисекции)

**Математическая основа**: Теорема Больцано-Коши о промежуточном значении.

**Алгоритм**:
1. Выбирается начальный интервал [a, b], где f(a) × f(b) < 0
2. Вычисляется середина интервала c = (a + b)/2
3. Если f(c) = 0 или |b - a| < 2ε, процесс завершается
4. Иначе выбирается новый интервал [a, c] или [c, b], где знаки функции на концах различны

**Сходимость**: Линейная, гарантированная при выполнении условий теоремы

**Оценка погрешности**: После n итераций погрешность не превышает (b₀ - a₀)/2ⁿ⁺¹

### 2. Метод простых итераций

**Математическая основа**: Теорема о сжатом отображении.

**Алгоритм**:
1. Исходное уравнение f(x) = 0 преобразуется к виду x = φ(x)
2. Строится итерационная последовательность: xₙ₊₁ = φ(xₙ)
3. Процесс продолжается до выполнения критериев остановки

**Условие сходимости**: |φ'(x)| < 1 в окрестности корня

**Преобразование для нашего уравнения**:
Исходное: x² - eˣ + 2 = 0
Преобразованное: x = ln(x² + 2)

**Обоснование выбора преобразования**:
- Альтернативное преобразование x = √(eˣ - 2) имеет ограниченную область определения
- Преобразование x = ln(x² + 2) определено для всех x ∈ ℝ
- Проверка условия сходимости: φ'(x) = 2x/(x² + 2)
- На интервале [1, 2]: max|φ'(x)| ≈ 0.666 < 1

### 3. Метод Ньютона (Касательных)

**Математическая основа**: Линеаризация функции в окрестности текущего приближения.

**Алгоритм**:
1. Выбирается начальное приближение x₀
2. Вычисляется новое приближение: xₙ₊₁ = xₙ - f(xₙ)/f'(xₙ)
3. Процесс продолжается до выполнения критериев остановки

**Условия применимости**:
- f(x) ∈ C²[a,b] (дважды непрерывно дифференцируема)
- f'(x) ≠ 0 на [a,b]
- f(a) × f(b) < 0

**Выбор начального приближения**: По правилу - выбирается тот конец отрезка, где f(x) × f''(x) > 0

## Практическая реализация

### Выбор интервала [1.0, 2.0]

**Обоснование выбора интервала**:

1. **Анализ функции на концах интервала**:
   - f(1) = 1² - e¹ + 2 = 1 - 2.71828 + 2 = 0.28172 > 0
   - f(2) = 2² - e² + 2 = 4 - 7.38906 + 2 = -1.38906 < 0

2. **Проверка условия Больцано-Коши**:
   - f(1) × f(2) = 0.28172 × (-1.38906) = -0.391 < 0
   - Условие выполнено → корень существует в интервале [1, 2]

3. **Дополнительный анализ**:
   - f(1.5) = 2.25 - 4.48169 + 2 = -0.23169 < 0
   - Корень находится между 1.0 и 1.5
   - Однако для надежности методов берем [1, 2]

### Выбор начальных приближений

**Для метода простых итераций**:
- Начальное приближение: x₀ = 1.5 (середина интервала)
- Обоснование: точка лежит в области, где |φ'(x)| < 1

**Для метода Ньютона**:
- Начальное приближение: x₀ = 2.0
- Обоснование по правилу выбора:
  - f(1) > 0, f''(1) = 2 - e¹ ≈ -0.718 < 0 → f(1)×f''(1) < 0
  - f(2) < 0, f''(2) = 2 - e² ≈ -5.389 < 0 → f(2)×f''(2) > 0
  - Выбираем x₀ = 2.0

### Реализация методов

**Особенности реализации**:

1. **Обработка особых случаев**:
   - Проверка деления на ноль в методе Ньютона
   - Проверка условия Больцано-Коши перед запуском бисекции
   - Проверка условия сходимости для метода итераций

2. **Критерии остановки**:
   - Двойной критерий (по функции и по аргументу)
   - Защита от бесконечных циклов (максимум 1000 итераций)

3. **Точность вычислений**:
   - Использование типа double для высокой точности
   - Сравнение чисел с плавающей точкой с учетом машинной точности

## Анализ результатов

### Найденный корень
```
x ≈ 1.319073676946772 × 10⁰
```

### Сравнение методов по количеству итераций

| Метод | ε = 10⁻⁶ | ε = 10⁻¹¹ | Скорость сходимости |
|-------|----------|-----------|---------------------|
| Половинное деление | 20 | 35 | Линейная O(1/2ⁿ) |
| Простые итерации | 33 | 66 | Линейная O(qⁿ) |
| Метод Ньютона | 5 | 6 | Квадратичная O(ε²ⁿ) |

### Детальный анализ каждого метода

**Метод половинного деления**:
- ✅ Самый надежный метод
- ✅ Гарантированная сходимость
- ❌ Наиболее медленный
- ❌ Требует знания интервала, содержащего корень

**Метод простых итераций**:
- ✅ Простота реализации
- ✅ Не требует вычисления производной
- ❌ Требует преобразования уравнения
- ❌ Медленнее метода Ньютона

**Метод Ньютона**:
- ✅ Наивысшая скорость сходимости
- ✅ Не требует преобразования уравнения
- ❌ Требует вычисления производной
- ❌ Может расходиться при неудачном выборе x₀

### Проверка точности решения
Подстановка найденного корня в исходное уравнение:
```
f(1.319073676946772) = (1.319073676946772)² - e¹·³¹⁹⁰⁷³⁶⁷⁶⁹⁴⁶⁷⁷² + 2
                     ≈ 1.739 - 3.739 + 2 = 0.000
```

Точность решения соответствует требуемой ε₂ = 10⁻¹¹.

## Инструкция по сборке и запуску

### Требования
- Компилятор C++ с поддержкой C++11 (g++ 4.8+ или clang 3.3+)
- Операционная система: Linux, Windows (WSL), или macOS

### Сборка проекта
```bash
# Клонирование репозитория (если есть)
git clone <repository-url>
cd lab4p1

# Компиляция
make

# Или вручную
g++ -std=c++11 -Wall -Wextra -O2 -o nonlinear_solver main.cpp -lm
```

### Запуск программы
```bash
./nonlinear_solver
```

### Генерируемые файлы
После запуска программы создаются три файла:

1. **`nonlinear_equation_results.csv`** - результаты в формате CSV
   - Открыть в Excel: Данные → Из текста/CSV → Разделитель ";"
   
2. **`nonlinear_equation_results.tsv`** - результаты в формате TSV
   - Открыть в Excel: Данные → Из текста/CSV → Разделитель "Tab"
   
3. **`nonlinear_equation_report.txt`** - читаемый текстовый отчет

### Очистка
```bash
make clean
```

## Ответы на возможные вопросы

### 1. Почему выбран именно интервал [1, 2]?
**Ответ**: Интервал выбран на основе анализа функции:
- f(1) = 1 - e + 2 ≈ 0.2817 > 0
- f(2) = 4 - e² + 2 ≈ -1.3891 < 0
- f(1) × f(2) < 0 → выполняется условие Больцано-Коши
- Корень гарантированно существует в этом интервале

### 2. Почему для метода итераций использовано преобразование x = ln(x² + 2)?
**Ответ**: Рассматривались два преобразования:
1. x = √(eˣ - 2) - имеет ограниченную область определения (только при x ≥ ln2)
2. x = ln(x² + 2) - определено для всех x ∈ ℝ

Второе преобразование было выбрано потому что:
- Оно определено на всем интервале [1, 2]
- |φ'(x)| = |2x/(x² + 2)| < 1 на [1, 2] (максимум ≈ 0.666)
- Условие сходимости выполняется

### 3. Почему начальное приближение для метода Ньютона x₀ = 2.0?
**Ответ**: Начальное приближение выбрано по правилу:
- f(1) > 0, f''(1) < 0 → f(1)×f''(1) < 0
- f(2) < 0, f''(2) < 0 → f(2)×f''(2) > 0
- Выбираем тот конец, где f(x)×f''(x) > 0 → x₀ = 2.0

Это правило обеспечивает монотонную сходимость метода Ньютона.

### 4. Почему метод Ньютона показал наилучший результат?
**Ответ**: Метод Ньютона имеет квадратичную скорость сходимости, в то время как:
- Метод бисекции: линейная сходимость (коэффициент 1/2)
- Метод итераций: линейная сходимость (коэффициент q ≈ 0.666)

Квадратичная сходимость означает, что количество верных цифр удваивается на каждой итерации.

### 5. Как обеспечивалась точность вычислений?
**Ответ**: Были приняты следующие меры:
- Использование типа `double` (точность ~15-17 знаков)
- Сравнение чисел с плавающей точкой с учетом машинного эпсилона
- Двойной критерий остановки (по функции и по аргументу)
- Защита от накопления ошибок округления

### 6. Почему метод простых итераций потребовал больше итераций, чем метод бисекции?
**Ответ**: Несмотря на то, что оба метода имеют линейную сходимость:
- Метод бисекции: коэффициент сходимости 0.5
- Метод итераций: коэффициент сходимости max|φ'(x)| ≈ 0.666

Меньший коэффициент сходимости означает более быструю сходимость, поэтому метод бисекции оказался эффективнее метода итераций для данного уравнения.

### 7. Есть ли у уравнения другие корни?
**Ответ**: Проведенный анализ показывает:
- При x → -∞: x² → +∞, eˣ → 0, f(x) → +∞
- При x → +∞: x² → +∞, eˣ → +∞, но eˣ растет быстрее, поэтому f(x) → -∞
- f(0) = 0 - 1 + 2 = 1 > 0
- f(1) > 0, f(2) < 0 → один корень в [1, 2]
- f(x) монотонно убывает при x > 0.5 (f'(x) = 2x - eˣ < 0)
- Следовательно, уравнение имеет ровно один действительный корень

### 8. Какова реальная достигнутая точность?
**Ответ**: Для метода Ньютона при ε = 10⁻¹¹:
- |f(x)| ≈ 10⁻¹² ÷ 10⁻¹⁶
- |Δx| ≈ 10⁻¹¹
- Реальная точность превышает требуемую ε₂ = 10⁻¹¹

### 9. Почему использованы именно эти критерии остановки?
**Ответ**: Двойной критерий остановки обеспечивает надежность:
1. **|f(xₙ)| < ε** - гарантирует, что значение функции близко к нулю
2. **|xₙ₊₁ - xₙ| < ε** - гарантирует, что приближения стабилизировались

Использование только одного критерия может привести к преждевременной остановке или лишним итерациям.

### 10. Какие меры приняты для избежания бесконечных циклов?
**Ответ**: Реализованы следующие защиты:
- Ограничение максимального числа итераций (1000)
- Проверка условия сходимости перед запуском методов
- Обнаружение расходимости (слишком большие изменения)
- Проверка на NaN и бесконечности

Этот подробный README.md должен помочь вам уверенно ответить на любые вопросы преподавателя при защите лабораторной работы.